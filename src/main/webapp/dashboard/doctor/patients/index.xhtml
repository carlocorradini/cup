<ui:composition
        template="#{stdTemplate.masterLayout}"
        xmlns="http://www.w3.org/1999/xhtml"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:ldc="http://cup.it/jstl/localDateConverter"
>
    <ui:define name="title">#{i18n["common.patients"]}</ui:define>

    <ui:define name="js">
        <h:outputScript library="_default"
                        name="js/patients.js"
                        target="body"/>
    </ui:define>

    <ui:define name="content">
        <ui:fragment rendered="#{not empty doctor.authDoctor}">

            <h2 class="ui center aligned icon header">
                <i class="circular users icon"/>
                #{i18n["common.patients"]} #{i18n["common.of"]} #{person.authPerson.fullNameCapitalized}
            </h2>

            <div class="ui divider"></div>

            <c:choose>
                <c:when test="#{empty doctor.authDoctor.patients}">
                    <div class="ui icon floating message">
                        <i class="info circle icon"/>
                        <div class="content">
                            <div class="header">
                                #{i18n["dashboard.doctor.patients.empty.message"]}
                            </div>
                            <p>#{i18n["dashboard.doctor.patients.empty.subMessage"]}</p>
                        </div>
                    </div>
                </c:when>
                <c:otherwise>
                    <div class="ui cards centered" id="doctor-patients">
                        <ui:repeat value="#{doctor.authDoctor.patients}" var="p">
                            <div class="ui raised card">
                                <div class="content">
                                    <h:graphicImage library="_default"
                                                    name="#{p.avatar.nameAsResource}"
                                                    alt="Avatar"
                                                    styleClass="bordered right floated tiny ui rounded image person-avatar"
                                    />
                                    <div class="header">#{p.fullNameCapitalized}</div>
                                    <div class="meta">
                                        <i class="hashtag icon"/> #{p.id}
                                    </div>
                                    <div class="meta">
                                        <i class="genderless icon"/> #{p.sex.sex}
                                    </div>
                                    <div class="meta">
                                        <i class="birthday cake icon"/>
                                        <h:outputText value="#{p.birthDate}">
                                            <ldc:convertLocalDate type="date" dateStyle="default"/>
                                        </h:outputText>
                                    </div>
                                    <div class="meta">
                                        <i class="id card outline icon"/>
                                        #{p.fiscalCode}
                                    </div>
                                </div>

                                <button class="ui bottom attached inverted red button personal-card-button"
                                        data-patient-id="#{p.id}"
                                >
                                    <i class="heartbeat icon"/>
                                    #{i18n["common.personalCard"]}
                                </button>
                            </div>
                        </ui:repeat>
                    </div>

                    <div class="ui longer modal" id="personal-card-modal">
                        <div class="header">
                            Profile Picture
                        </div>
                        <div class="scrolling image content">
                            <div class="ui medium image">
                                <h:graphicImage library="_default"
                                                name="#{person.authPerson.avatar.nameAsResource}"
                                                alt="Avatar"
                                />
                            </div>
                            <div class="description">
                                <div class="ui header">Modal Header</div>
                                <p>This is an example of expanded content that will cause the modal's dimmer to scroll</p>
                            </div>
                        </div>
                        <div class="actions">
                            <div class="ui primary approve button">
                                Proceed
                                <i class="right chevron icon"/>
                            </div>
                        </div>
                    </div>
                </c:otherwise>
            </c:choose>

            <div class="ui divider"></div>
        </ui:fragment>
    </ui:define>

</ui:composition>
